{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "Lacework FortiCNAPP > Potentially Compromised Host Alert",
    "aliasName": null,
    "tag": null,
    "description": "Incident response playbook with chatops approval chain for stop instance and take volume snapshot.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/db426f50-e61a-4c76-b7d2-7df39beaf917",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/d7b24651-b8fa-4b8e-8de0-4cf88b63a0b3",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Add Original Security Groups Remediation Tag to Instance",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ vars.item.data.Reservations[0].OwnerId }}",
                "params": {
                    "tag_key": "fortisoar_remediation_original_security_groups",
                    "tag_value": "{%- set results=[] %}{%- for groups_list in vars.steps.AWS_Security_Groups %}{%- for security_groups in groups_list.original_security_groups %}{%- if security_groups.InstanceId == vars.item.data.Reservations[0].Instances[0].InstanceId %}{%- if  results.append(security_groups.SecurityGroup) %}{%- endif %}{%- endif %}{%- endfor %}{%- endfor %}{{ results | join(\",\") }}",
                    "assume_role": false,
                    "instance_id": "{{ vars.item.data.Reservations[0].Instances[0].InstanceId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{ vars.steps.Get_AWS_Instance_Details }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "aws",
                "operation": "add_tag_to_instance",
                "operationTitle": "Add Instance Tag",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "20697992-7c01-4789-affb-53aca935f1f0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Add Remediation Action Tag to Instance",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ vars.item.data.Reservations[0].OwnerId }}",
                "params": {
                    "tag_key": "fortisoar_remediation",
                    "tag_value": "{{ vars.action }}",
                    "assume_role": false,
                    "instance_id": "{{ vars.item.data.Reservations[0].Instances[0].InstanceId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{ vars.steps.Get_AWS_Instance_Details }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "aws",
                "operation": "add_tag_to_instance",
                "operationTitle": "Add Instance Tag",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "140",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "ee23334d-2121-48f6-8838-a1ff6a7b6fbc"
        },
        {
            "@type": "WorkflowStep",
            "name": "AWS Enrichment",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "step_iri": "\/api\/3\/workflow_steps\/6d429e9c-d4b3-4740-a1b0-becc51b29ba4",
                        "condition": "{{ vars.aws == true }}",
                        "step_name": "Get Instance Details"
                    },
                    {
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/e33302a9-a4e8-4458-bb7b-da6ceaa24d41",
                        "step_name": "End"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/e71e4003-4a11-49da-a66c-1b8a91bdc099",
            "uuid": "0114c7dc-d19b-4ea0-9f58-bc137f3fa60c"
        },
        {
            "@type": "WorkflowStep",
            "name": "AWS Security Groups",
            "description": null,
            "arguments": {
                "for_each": {
                    "item": "{{ vars.steps.Get_AWS_Instance_Details }}",
                    "parallel": false,
                    "condition": ""
                },
                "security_groups": "{%- set result=[] %}\n{%- for security_group in vars.item.data.Reservations[0].Instances[0].SecurityGroups %}\n\t{%- if security_group.GroupName | regex_search(vars.protected_security_groups) %}\n\t\t{%- if result.append({ \"InstanceId\" : vars.item.data.Reservations[0].Instances[0].InstanceId, \"VpcId\": vars.item.data.Reservations[0].Instances[0].VpcId, \"SecurityGroup\": security_group.GroupName}) %}{% endif %}\n\t{%- endif %}\n{%- endfor %}\n{%- if result.append({ \"InstanceId\" : vars.item.data.Reservations[0].Instances[0].InstanceId, \"SecurityGroup\": vars.containment_security_group }) %}{% endif %}\n{{ result }}",
                "original_security_groups": "{%- set result=[] %}\n{%- for security_group in vars.item.data.Reservations[0].Instances[0].SecurityGroups %}\n\t\t{%- if result.append({ \"InstanceId\" : vars.item.data.Reservations[0].Instances[0].InstanceId, \"VpcId\": vars.item.data.Reservations[0].Instances[0].VpcId, \"SecurityGroup\": security_group.GroupName}) %}{% endif %}\n{%- endfor %}\n{{ result }}"
            },
            "status": null,
            "top": "740",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "f339594c-0293-4776-a0cb-85aa57995f77"
        },
        {
            "@type": "WorkflowStep",
            "name": "Azure Enrichment",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "step_iri": "\/api\/3\/workflow_steps\/531c42d7-406f-4cf2-9611-f9cea6efaddd",
                        "condition": "{{ vars.azure }}",
                        "step_name": "Get Azure Instance Details"
                    },
                    {
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/7cc258a8-3c0a-477b-9522-ea98aa831c36",
                        "step_name": "Skip Azure Enrichment"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "60",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/a5fa5ed2-4537-448d-a8aa-384b5f6260f6",
            "uuid": "5f840287-a9b9-4b48-9bf6-d7c14d30c7af"
        },
        {
            "@type": "WorkflowStep",
            "name": "Block AWS Internet",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ vars.item.data.Reservations[0].OwnerId }}",
                "params": {
                    "group_list": "{%- set results=[] %}{%- for groups_list in vars.steps.AWS_Security_Groups %}{%- for security_groups in groups_list.security_groups %}{%- if security_groups.InstanceId == vars.item.data.Reservations[0].Instances[0].InstanceId %}{%- if  results.append(security_groups.SecurityGroup) %}{%- endif %}{%- endif %}{%- endfor %}{%- endfor %}{{ results | join(\",\") }}",
                    "assume_role": false,
                    "instance_id": "{{ vars.item.data.Reservations[0].Instances[0].InstanceId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{ vars.steps.Get_AWS_Instance_Details }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "aws",
                "operation": "add_security_group_to_instance",
                "operationTitle": "Add Security Group To Instance",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "940",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "8370e996-9091-494b-ad61-016bbe25a6ff"
        },
        {
            "@type": "WorkflowStep",
            "name": "Block Internet Access",
            "description": null,
            "arguments": {
                "action": "block_internet"
            },
            "status": null,
            "top": "680",
            "left": "480",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "cbe58838-1208-4f33-ad91-ba9c406ae88f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check AWS Revoke Egress Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "block internet",
                        "step_iri": "\/api\/3\/workflow_steps\/f339594c-0293-4776-a0cb-85aa57995f77",
                        "condition": "{{ vars.action | regex_search(\"block_internet\") is not none }}",
                        "step_name": "AWS Security Groups"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/54f7c8ce-eabe-4dd1-ab1d-d4a90f0fdbf0",
                        "step_name": "Skip AWS Block Internet"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "600",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "d174b22c-0a5b-4617-b506-780180a04556"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check AWS Snapshot Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "snapshot",
                        "step_iri": "\/api\/3\/workflow_steps\/350fe794-821b-4332-a3c4-b7d72e639872",
                        "condition": "{{ vars.action | regex_search(\"snapshot\") is not none }}",
                        "step_name": "Take AWS Volume Snapshot"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/41bb455a-cde3-47d8-a63a-4bf190eaeb61",
                        "step_name": "Skip AWS Snapshot"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "400",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "1ab23e9f-b041-43e7-8303-30fab2803e44"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check AWS Stop Instance Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "stop",
                        "step_iri": "\/api\/3\/workflow_steps\/a02cbfb8-75a3-4ca4-8166-915d251086ea",
                        "condition": "{{ vars.action | regex_search(\"stop\") is not none }}",
                        "step_name": "Stop AWS Instance Action"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/e76ea4e4-2c23-4b13-9cce-86b953401283",
                        "step_name": "Skip AWS Stop"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "200",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "85240cfd-0c2c-4ebf-b1e3-7c9b11fd38ad"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check Azure Snapshot Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/7ee1ebd4-a885-49b3-b7a4-357b27e038db",
                        "step_name": "Skip Azure Snapshot"
                    },
                    {
                        "option": "snpshot",
                        "step_iri": "\/api\/3\/workflow_steps\/24fb23e4-8103-44f6-9e1c-aa7d543433a1",
                        "condition": "{{ vars.action | regex_search(\"snapshot\") is not none }}",
                        "step_name": "Take Azure Volume Snapshot"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "261",
            "left": "337",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "a85ea8f8-ca9e-4866-830d-b81ffbc4eb04"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check Azure Stop Instance Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "stop",
                        "step_iri": "\/api\/3\/workflow_steps\/566a4f8d-651f-4701-a178-27bdac293e6a",
                        "condition": "{{ vars.action | regex_search(\"stop\") is not none }}",
                        "step_name": "Stop Azure Instance Action"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/b6503915-6fe9-496b-9584-f25491dff3f6",
                        "step_name": "Skip Azure Stop"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "61",
            "left": "337",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "80f336ac-ee72-493f-bc0b-094d94a20038"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check GCP Snapshot Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "snapshot",
                        "step_iri": "\/api\/3\/workflow_steps\/baa1c4d6-f511-4365-aef8-29c4fead905e",
                        "condition": "{{ vars.action | regex_search(\"snapshot\") is not none }}",
                        "step_name": "Take GCP Volume Snapshot"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/6675f9a1-1249-4a74-9f84-818507511a72",
                        "step_name": "Skip GCP Snapshot"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "298",
            "left": "359",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "ef85712d-7036-4a1e-a1b2-3a225864e410"
        },
        {
            "@type": "WorkflowStep",
            "name": "Check GCP Stop Instance Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "stop",
                        "step_iri": "\/api\/3\/workflow_steps\/e869ae0c-cb73-42d0-ab0b-e82a31cf393a",
                        "condition": "{{ vars.action | regex_search(\"stop\") is not none }}",
                        "step_name": "Stop GCP Instance Action"
                    },
                    {
                        "option": "skip",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/a83fa151-2074-43c0-9c1d-cc3f681633cb",
                        "step_name": "Skip GCP Stop"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "98",
            "left": "359",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "3c18b10c-2b30-4ad7-80fb-093ba05686bc"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Alert",
            "description": null,
            "arguments": {
                "action": "close_alert"
            },
            "status": null,
            "top": "80",
            "left": "20",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/32420e60-b900-4bad-853e-43cecb25de86",
            "uuid": "e79af345-633f-4459-af25-f2e475f6e086"
        },
        {
            "@type": "WorkflowStep",
            "name": "Close Lacework Alert",
            "description": null,
            "arguments": {
                "name": "Lacework FortiCNAPP",
                "config": "{{ vars.lacework_subaccount }}",
                "params": {
                    "reason": "Other",
                    "alertId": "{{ vars.alert_details.alertId }}",
                    "comment": "*FortiSOAR*: Closing Alert"
                },
                "version": "1.0.0",
                "connector": "fortinet-forticnapp",
                "operation": "close_alert",
                "operationTitle": "Close Alert",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "200",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/32420e60-b900-4bad-853e-43cecb25de86",
            "uuid": "e4eb8190-7e71-4da9-9741-47b51c5d0ef8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Format AWS Response",
            "description": null,
            "arguments": {
                "bot_message": "[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Alert ID {{ vars.alert_details.alertId }}*: Action Completed\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Action*: ```{{ vars.action }}```\"\n\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Stop Instance Result*: {{ vars.bot_stop_instance_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"') }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Snapshot Result*: {{ vars.bot_snapshot_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Block Internet Access Result*: {{ vars.bot_block_internet_access_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  }\n]"
            },
            "status": null,
            "top": "1380",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "6433799d-fa71-4e98-b08b-fe9d66142036"
        },
        {
            "@type": "WorkflowStep",
            "name": "Format Azure Response",
            "description": null,
            "arguments": {
                "bot_message": "[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Alert ID {{ vars.alert_details.alertId }}*: Action Completed\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Action*: ```{{ vars.action }}```\"\n\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Stop Instance Result*: {{ vars.bot_stop_instance_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"') }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Snapshot Result*: {{ vars.bot_snapshot_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Block Internet Result*: {{ vars.bot_block_internet_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  }\n]"
            },
            "status": null,
            "top": "1380",
            "left": "320",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "9fe44bd4-b3e1-428e-94e3-d3908453a9dc"
        },
        {
            "@type": "WorkflowStep",
            "name": "Format GCP Response",
            "description": null,
            "arguments": {
                "bot_message": "[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Alert ID {{ vars.alert_details.alertId }}*: Action Completed\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Action*: ```{{ vars.action }}```\"\n\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Stop Instance Result*: {{ vars.bot_stop_instance_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"') }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Snapshot Result*: {{ vars.bot_snapshot_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Block Internet Result*: {{ vars.bot_block_internet_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  }\n]"
            },
            "status": null,
            "top": "1380",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "f0a5b9ab-a427-4999-8b55-11b40aa92fa8"
        },
        {
            "@type": "WorkflowStep",
            "name": "GCP Enrichment",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "step_iri": "\/api\/3\/workflow_steps\/196ae57a-701f-47c4-b753-7c25dcee418f",
                        "condition": "{{ vars.gcp == true }}",
                        "step_name": "Get GCP Instance Details"
                    },
                    {
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/b68a1e49-ae81-4e89-bd4e-20bf0c924430",
                        "step_name": "Skip GCP Enrichment"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/372e94c5-3efa-4383-9606-dd4daa5c0e9b",
            "uuid": "0697d91a-145f-4563-88f2-9f3d45965a7c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get AWS Instance Details",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ vars.item.PROPS.tags.Account }}",
                "params": {
                    "assume_role": false,
                    "instance_id": "{{ vars.item.PROPS.tags.InstanceId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{ vars.machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "aws",
                "operation": "describe_instance",
                "operationTitle": "Get Instance Details",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "160",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/e71e4003-4a11-49da-a66c-1b8a91bdc099",
            "uuid": "6d429e9c-d4b3-4740-a1b0-becc51b29ba4"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Azure Instance Details",
            "description": null,
            "arguments": {
                "name": "Azure Commands",
                "config": "{{ vars.item.PROPS.tags.SubscriptionName }}",
                "params": {
                    "command": "vm list",
                    "optional_parameters": "--query \"[?vmId=='{{vars.item.PROPS.tags.InstanceId}}']\""
                },
                "version": "1.0.0",
                "for_each": {
                    "item": "{{ vars.azure_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "azure-commands",
                "operation": "generic_command",
                "operationTitle": "Execute Azure Command",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "160",
            "left": "60",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/a5fa5ed2-4537-448d-a8aa-384b5f6260f6",
            "uuid": "531c42d7-406f-4cf2-9611-f9cea6efaddd"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get GCP Instance Details",
            "description": null,
            "arguments": {
                "name": "Google Cloud Compute",
                "config": "{{ vars.item.PROPS.tags.ProjectId }}",
                "params": {
                    "zone": "{{ vars.item.PROPS.tags.Zone }}",
                    "resource_id": "{{ vars.item.PROPS.tags.InstanceName }}"
                },
                "version": "1.2.0",
                "for_each": {
                    "item": "{{ vars.gcp_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "google-cloud-compute",
                "operation": "describe_instance",
                "operationTitle": "Get Instance Details",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "160",
            "left": "40",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/372e94c5-3efa-4383-9606-dd4daa5c0e9b",
            "uuid": "196ae57a-701f-47c4-b753-7c25dcee418f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Map Instance to Instance Volumes",
            "description": "Enumerate all of the discovered instances and create a list of all running instances and their attached volumes.",
            "arguments": {
                "instanceVolumes": "{% set results=[] %}\n{% for instance_detail in vars.steps.Get_AWS_Instance_Details %}\n\t{% if (instance_detail.data.Reservations | length) > 0 and instance_detail.data.Reservations[0].Instances[0].State.Name == \"running\" %}\n\t\t{% set volumeIds=[] %}\n\t\t{% for block_device in instance_detail.data.Reservations[0].Instances[0].BlockDeviceMappings %}\n\t\t\t{% if block_device.Ebs.Status == \"attached\" %}\n\t\t\t\t{% if volumeIds.append( instance_detail.data.Reservations[0].OwnerId ~ ':' ~ block_device.Ebs.VolumeId) %}{% endif %}\n\t\t\t{% endif %}\n\t\t{% endfor %}\n\t\t{% if results.append({ \"instanceId\":  instance_detail.data.Reservations[0].Instances[0].InstanceId, \"state\": instance_detail.data.Reservations[0].Instances[0].State.Name, \"volumeIds\" : volumeIds, \"account\" : instance_detail.data.Reservations[0].OwnerId } ) %}{% endif %}\n\t{% endif %}\n{% endfor %}\n{{ results }}"
            },
            "status": null,
            "top": "80",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "e9e6e3ca-bf43-4bbc-a7db-2c8294fe7c74"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Action",
            "description": null,
            "arguments": {
                "action": "none",
                "bot_message": "[\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Alert ID {{ vars.alert_details.alertId }}*: Action Completed\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Action*: ```{{ vars.action }}```\"\n\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Stop Instance Result*: {{ vars.bot_stop_instance_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"') }}\"\n    }\n  },\n  {\n    \"type\": \"section\",\n    \"text\": {\n      \"type\": \"mrkdwn\",\n      \"text\": \"*Snapshot Result*: {{ vars.bot_snapshot_message |  replace(\"\\n\", \"\\\\n\") |  replace('\\\\\"', '&ESCAPE;') |  replace('\"', '\\\\\"') | replace('&ESCAPE;', '\\\\\\\"')  }}\"\n    }\n  }\n]"
            },
            "status": null,
            "top": "680",
            "left": "2900",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "e08a3618-e9c4-4bc9-ba77-906cce535b42"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Action For Alert",
            "description": null,
            "arguments": {
                "action": "none"
            },
            "status": null,
            "top": "80",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/32420e60-b900-4bad-853e-43cecb25de86",
            "uuid": "988a6662-fa87-4edd-b6d3-a244bc612147"
        },
        {
            "@type": "WorkflowStep",
            "name": "Payload",
            "description": null,
            "arguments": {
                "payload": "{{ (vars.input.records[0].sourcedata | from_json) }}"
            },
            "status": null,
            "top": "140",
            "left": "1860",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "3cc4b746-6ed4-4063-9172-b42dc2d95daf"
        },
        {
            "@type": "WorkflowStep",
            "name": "Payload Configuration",
            "description": "Setup provider variables from the provided payload",
            "arguments": {
                "aws": "{{ vars.payload.instanceIds | length > 0 }}",
                "gcp": "{{ vars.payload.gcp_instanceIds | length > 0 }}",
                "azure": "{{ vars.payload.azure_instanceIds | length > 0 }}",
                "users": "{{ vars.payload.users }}",
                "machines": "{{ vars.payload.machines }}",
                "instanceIds": "{{ vars.payload.instanceIds }}",
                "gcp_machines": "{{ vars.payload.gcp_machines }}",
                "user_details": "{{ vars.payload.user_details }}",
                "alert_details": "{{ vars.payload }}",
                "azure_machines": "{{ vars.payload.azure_machines }}",
                "gcp_instanceIds": "{{ vars.payload.gcp_instanceIds }}",
                "lacework_account": "{{ vars.payload.lacework_account }}",
                "azure_instanceIds": "{{ vars.payload.azure_instanceIds }}",
                "lacework_subaccount": "{{ vars.payload.lacework_subaccount | lower }}"
            },
            "status": null,
            "top": "60",
            "left": "1460",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "aa779e39-8ebe-4eb2-aba2-fa9e9312ac65"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Approval Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "slack",
                        "step_iri": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
                        "condition": "{{ vars.slack }}",
                        "step_name": "Slack Approval Action"
                    },
                    {
                        "option": "teams",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
                        "step_name": "Teams Approval Action"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "380",
            "left": "1460",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "b0c3d099-b158-46a6-8a1a-be7a25bb684e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Channel Response",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "slack",
                        "step_iri": "\/api\/3\/workflow_steps\/8086973a-9e1f-40dc-9e9d-f429c6742496",
                        "condition": "{{ vars.slack }}",
                        "step_name": "Send Slack Response"
                    },
                    {
                        "option": "teams",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/f650e38b-294e-4b37-83a1-815e2e471afe",
                        "step_name": "Send Teams Response"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "60",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "4ffca273-5190-459e-a8a4-aeb92945f81e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Prompt for Additional Action",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "slack",
                        "step_iri": "\/api\/3\/workflow_steps\/4cf8cad9-d8dd-4e53-9150-a18291a5df19",
                        "condition": "{{ vars.slack }}",
                        "step_name": "Slack Prompt to Additional Action"
                    },
                    {
                        "option": "teams",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/de0bf09d-7154-4ac3-b341-95e44f07db8f",
                        "step_name": "Teams Prompt to Additional Action"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "380",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "b9ddd357-cfc6-43dc-80ef-2b0b3f68a3f7"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Slack Response",
            "description": null,
            "arguments": {
                "name": "Slack",
                "config": "07eb7f2f-f03b-4407-8a27-b8a6c47a5c13",
                "params": {
                    "blocks": "{{ vars.bot_message }}",
                    "channel": "{{ vars.slack_channel }}",
                    "message": "Block Content",
                    "email_id": "",
                    "thread_ts": "",
                    "attachments": []
                },
                "version": "3.2.0",
                "connector": "slack",
                "operation": "send_message",
                "operationTitle": "Send Message",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "180",
            "left": "20",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "8086973a-9e1f-40dc-9e9d-f429c6742496"
        },
        {
            "@type": "WorkflowStep",
            "name": "Send Teams Response",
            "description": null,
            "arguments": {
                "name": "Microsoft Teams",
                "config": "9feb801c-8584-4a91-8700-d3c98ba1ec9e",
                "params": {
                    "type": "Text Message",
                    "message": "{%- for message in vars.bot_message %}\n{{ message.text.text }}\n{% endfor %}",
                    "conversation_id": "{{ vars.teams_channel_id }}"
                },
                "version": "3.0.0",
                "connector": "microsoft-teams",
                "operation": "send_message_or_approval_form_to_bot",
                "operationTitle": "Send Bot Message\/Input Form",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "180",
            "left": "540",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "f650e38b-294e-4b37-83a1-815e2e471afe"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set AWS Security Group Defaults",
            "description": "Define protected_security_groups regex for protected security groups, these matching groups will not be removed from actioned instances. Additionally define the containment_security_group name for the block inbound\/outbound internet access.",
            "arguments": {
                "protected_security_groups": "^[^-]+\\-vpcep\\-sg\\-.*",
                "containment_security_group": "containment-sg"
            },
            "status": null,
            "top": "160",
            "left": "1460",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "dca1f4ed-62ee-4468-ace1-3833e33dd8a9"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After AWS Block Internet",
            "description": null,
            "arguments": {
                "bot_block_internet_access_message": "```\n{{ vars.steps.Block_AWS_Internet | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "1000",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "58d3a076-2f52-4239-bc62-07516c2a505e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After AWS Instance Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "```\n{{ vars.steps.Stop_AWS_Instance_Action | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "340",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "8eef4a31-4685-46e6-895b-9f528a5ea9f1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After AWS Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "```\n{{ vars.steps.Take_AWS_Volume_Snapshot | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "560",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "937623e9-daea-4475-b9e9-672031fdbfcc"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After Azure Instance Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "```\n{{ vars.steps.Stop_Azure_Instance_Action | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "221",
            "left": "657",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "708aacb7-bdbd-4bff-b7e9-38f4789ada37"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After Azure Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "```\n{{ vars.steps.Take_Azure_Volume_Snapshot | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "420",
            "left": "640",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "46af9b84-30ee-4e01-b579-b91fb6526045"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After GCP Block Internet Not Supported",
            "description": null,
            "arguments": {
                "bot_block_internet_message": "Currently Not Supported for Google Cloud"
            },
            "status": null,
            "top": "560",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "208a5a30-195f-4fcb-be00-d0e4a4434ffd"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After GCP Instance Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "```\n{{ vars.steps.Stop_GCP_Instance_Action | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "258",
            "left": "679",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "e702b453-33b4-4f8c-bbc7-7e42b5fc7395"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message After GCP Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "```\n{{ vars.steps.Take_GCP_Volume_Snapshot | to_nice_json(indent=4) }}\n```"
            },
            "status": null,
            "top": "440",
            "left": "680",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "83f59eaa-bfbe-4dc9-aa31-8af616122334"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Bot Message Azure Not Supported",
            "description": null,
            "arguments": {
                "bot_block_internet_message": "Currently Not Supported for Azure"
            },
            "status": null,
            "top": "600",
            "left": "640",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "8937a756-e5b7-40e4-b475-bb4808a04ba8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Set Slack and Teams Defaults",
            "description": "Enable\/Disable Team\/Slack response flows. Set Slack\/Team alert channel.\n\nExample:\nslack_channel: C07PXXXXXXX\nteams_channel: Security Operations\nteams_channel_id: 19:xxxxxxxxxxxxxxxxxxxx@thread.tacv2\nteams_channel_group_id: xxxxx-xxx-xxxx-xxxx-xxxxxx",
            "arguments": {
                "slack": "true",
                "teams": "false",
                "slack_channel": "<YOUR SLACK CHANNEL ID>",
                "teams_channel": "<YOUR TEAMS CHANNEL NAME>",
                "teams_channel_id": "<YOUR TEAMS CHANNEL ID>",
                "teams_channel_group_id": "<YOUR TEAMS CHANNEL GROUP ID>"
            },
            "status": null,
            "top": "260",
            "left": "1460",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "6e76b5f2-6cb3-4eae-b4b3-77e6b538e812"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip AWS Block Internet",
            "description": null,
            "arguments": {
                "bot_block_internet_access_message": "No Action Taken"
            },
            "status": null,
            "top": "720",
            "left": "80",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "54f7c8ce-eabe-4dd1-ab1d-d4a90f0fdbf0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip AWS Enrichment",
            "description": null,
            "arguments": {
                "end": "true"
            },
            "status": null,
            "top": "60",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e71e4003-4a11-49da-a66c-1b8a91bdc099",
            "uuid": "e33302a9-a4e8-4458-bb7b-da6ceaa24d41"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip AWS Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "No Action Taken"
            },
            "status": null,
            "top": "500",
            "left": "80",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "41bb455a-cde3-47d8-a63a-4bf190eaeb61"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip AWS Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "No Action Taken"
            },
            "status": null,
            "top": "300",
            "left": "80",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "e76ea4e4-2c23-4b13-9cce-86b953401283"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip Azure Enrichment",
            "description": null,
            "arguments": {
                "end": "true"
            },
            "status": null,
            "top": "60",
            "left": "360",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/a5fa5ed2-4537-448d-a8aa-384b5f6260f6",
            "uuid": "7cc258a8-3c0a-477b-9522-ea98aa831c36"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip Azure Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "No Action Taken"
            },
            "status": null,
            "top": "361",
            "left": "17",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "7ee1ebd4-a885-49b3-b7a4-357b27e038db"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip Azure Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "No Action Taken"
            },
            "status": null,
            "top": "161",
            "left": "17",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "b6503915-6fe9-496b-9584-f25491dff3f6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip GCP Enrichment",
            "description": null,
            "arguments": {
                "end": "true"
            },
            "status": null,
            "top": "60",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/372e94c5-3efa-4383-9606-dd4daa5c0e9b",
            "uuid": "b68a1e49-ae81-4e89-bd4e-20bf0c924430"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip GCP Snapshot",
            "description": null,
            "arguments": {
                "bot_snapshot_message": "No Action Taken"
            },
            "status": null,
            "top": "398",
            "left": "39",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "6675f9a1-1249-4a74-9f84-818507511a72"
        },
        {
            "@type": "WorkflowStep",
            "name": "Skip GCP Stop",
            "description": null,
            "arguments": {
                "bot_stop_instance_message": "No Action Taken"
            },
            "status": null,
            "top": "198",
            "left": "39",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "a83fa151-2074-43c0-9c1d-cc3f681633cb"
        },
        {
            "@type": "WorkflowStep",
            "name": "Slack Approval Action",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Alert ID {{ vars.alert_details.alertId }}: {{ vars.alert_details.alertName }}",
                        "description": "The following {% if vars.aws %}aws{% elif vars.gcp %}gcp{% elif vars.azure %}azure{% endif %} instances were identified as being potentially compromised:\n\n{% if vars.aws %}\n{% for instance in vars.machines %}\n- *Account*: `{{ instance.PROPS.tags.Account }}`\n- *InstanceId*: `{{ instance.PROPS.tags.InstanceId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.Hostname }}`\n\n{% endfor %}\n{% elif vars.gcp %}\n{% for instance in vars.gcp_machines %}\n- *OrganizationId*: `{{ instance.PROPS.tags.OrganizationId }}`\n- *ProjectId*: `{{ instance.PROPS.tags.ProjectId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.InstanceName }}`\n\n{% endfor %}\n{% elif vars.azure %}\n{% for instance in vars.azure_machines %}\n- *TenantId*: `{{ instance.PROPS.tags.TenantId }}`\n- *SubscriptionId*: `{{ instance.PROPS.tags.SubscriptionId }}`\n- *SubscriptionName*: `{{ instance.PROPS.tags.SubscriptionName }}`\n- *InstanceId*: `{{ instance.PROPS.tags.InstanceId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.Hostname }}`\n\n{% endfor %}\n{% endif %}\n\nView Alert in Lacework FortiCNAPP:\nhttps:\/\/{{vars.lacework_account}}.lacework.net\/ui\/investigation\/monitor\/AlertInbox\/{{vars.alert_details.alertId}}\/details?accountName={{vars.lacework_subaccount|upper}}\n\nView Alert in FortiSOAR:\nhttps:\/\/{{globalVars.Server_fqhn}}\/modules\/alerts\/{{vars.input.records[0][\"uuid\"]}}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "assignedToTeam": [],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false,
                    "externalRecipients": "{% if vars.slack %}{{ vars.slack_channel }}{% else %}{{ vars.teams_channel }}{% endif %}"
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Stop Instance",
                            "primary": false,
                            "step_iri": "\/api\/3\/workflow_steps\/76e84470-aaff-4216-9106-6d4efd6d46a6"
                        },
                        {
                            "option": "Stop Instance and Take Volume Snapshot",
                            "step_iri": "\/api\/3\/workflow_steps\/6ee47680-cbf9-458c-846d-b0ae042f4389"
                        },
                        {
                            "option": "Take Volume Snapshot",
                            "step_iri": "\/api\/3\/workflow_steps\/dd840d1d-f36c-4aee-b7e3-bd68c3af6667"
                        },
                        {
                            "option": "Block Internet Access",
                            "step_iri": "\/api\/3\/workflow_steps\/cbe58838-1208-4f33-ad91-ba9c406ae88f"
                        },
                        {
                            "option": "No Action",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/e08a3618-e9c4-4bc9-ba77-906cce535b42"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "inputExternalUser": false,
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inputInternalUsers": true,
                "customEmailExternal": false,
                "customEmailInternal": false,
                "inline_channel_list": [
                    "\/api\/3\/picklists\/afb18b7f-510b-471a-9b9c-7f4646edd4ee"
                ],
                "external_channel_list": [],
                "unauthenticated_input": true,
                "external_email_subject": "A FortiSOAR playbook is requesting your input",
                "internal_email_subject": null,
                "custom_email_body_external": null,
                "custom_email_body_internal": null,
                "external_email_attachments": null,
                "internal_email_attachments": null
            },
            "status": null,
            "top": "480",
            "left": "480",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "cc17b48d-210d-4bd6-93d8-fb3289e0a3a0"
        },
        {
            "@type": "WorkflowStep",
            "name": "Slack Prompt to Additional Action",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Alert ID {{ vars.alert_details.alertId }}: {{ vars.alert_details.alertName }}",
                        "description": "Actions associated with this alert have completed. Would you like to close the alert?\n\nView Alert in Lacework FortiCNAPP:\nhttps:\/\/{{vars.lacework_account}}.lacework.net\/ui\/investigation\/monitor\/AlertInbox\/{{vars.alert_details.alertId}}\/details?accountName={{vars.lacework_subaccount|upper}}\n\nView Alert in FortiSOAR:\nhttps:\/\/{{globalVars.Server_fqhn}}\/modules\/alerts\/{{vars.input.records[0][\"uuid\"]}}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "assignedToTeam": [],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false,
                    "externalRecipients": "{% if vars.slack %}{{ vars.slack_channel }}{% else %}{{ vars.teams_channel }}{% endif %}"
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Close Alert",
                            "step_iri": "\/api\/3\/workflow_steps\/e79af345-633f-4459-af25-f2e475f6e086"
                        },
                        {
                            "option": "No Action",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/988a6662-fa87-4edd-b6d3-a244bc612147"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "inputExternalUser": false,
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inputInternalUsers": true,
                "customEmailExternal": false,
                "customEmailInternal": false,
                "inline_channel_list": [
                    "\/api\/3\/picklists\/afb18b7f-510b-471a-9b9c-7f4646edd4ee"
                ],
                "external_channel_list": [],
                "unauthenticated_input": true,
                "external_email_subject": "A FortiSOAR playbook is requesting your input",
                "internal_email_subject": null,
                "custom_email_body_external": null,
                "custom_email_body_internal": null,
                "external_email_attachments": null,
                "internal_email_attachments": null
            },
            "status": null,
            "top": "460",
            "left": "20",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "4cf8cad9-d8dd-4e53-9150-a18291a5df19"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "alerts",
                "resources": [
                    "alerts"
                ],
                "__triggerLimit": true,
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "triggerOnSource": true,
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "OR",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "source",
                            "value": "Lacework FortiCNAPP: Potentially Compromised Host",
                            "operator": "eq",
                            "_operator": "eq"
                        },
                        {
                            "type": "primitive",
                            "field": "source",
                            "value": "Lacework FortiCNAPP: Potential Penetration Test",
                            "operator": "eq",
                            "_operator": "eq"
                        }
                    ]
                },
                "triggerOnReplicate": false
            },
            "status": null,
            "top": "40",
            "left": "1860",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "group": null,
            "uuid": "d7b24651-b8fa-4b8e-8de0-4cf88b63a0b3"
        },
        {
            "@type": "WorkflowStep",
            "name": "Stop AWS Instance Action",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ vars.item.account }}",
                "params": {
                    "assume_role": false,
                    "instance_id": "{{ vars.item.instanceId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{{ vars.instanceVolumes }}",
                    "parallel": false,
                    "condition": "{{vars.item.state == \"running\"}}"
                },
                "connector": "aws",
                "operation": "stop_instance",
                "operationTitle": "Stop Instance",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "a02cbfb8-75a3-4ca4-8166-915d251086ea"
        },
        {
            "@type": "WorkflowStep",
            "name": "Stop Azure Instance Action",
            "description": null,
            "arguments": {
                "name": "Azure Compute",
                "config": "{{ vars.item.PROPS.tags.SubscriptionId }}",
                "params": {
                    "subs_id": "{{ vars.item.PROPS.tags.SubscriptionId }}",
                    "vm_name": "{{ vars.item.PROPS.tags.InstanceName }}",
                    "resource_group_name": "{{ vars.item.PROPS.tags.ResourceGroup }}"
                },
                "version": "1.2.0",
                "for_each": {
                    "item": "{{ vars.azure_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "azure-compute",
                "operation": "stop_instance",
                "operationTitle": "Stop an Instance",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "161",
            "left": "337",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "566a4f8d-651f-4701-a178-27bdac293e6a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Stop GCP Instance Action",
            "description": null,
            "arguments": {
                "name": "Google Cloud Compute",
                "config": "{{ vars.item.PROPS.tags.ProjectId }}",
                "params": {
                    "zone": "{{ vars.item.PROPS.tags.Zone }}",
                    "resource_id": "{{ vars.item.PROPS.tags.InstanceName }}"
                },
                "version": "1.2.0",
                "for_each": {
                    "item": "{{ vars.gcp_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "google-cloud-compute",
                "operation": "stop_instance",
                "operationTitle": "Stop Instance",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "198",
            "left": "359",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "e869ae0c-cb73-42d0-ab0b-e82a31cf393a"
        },
        {
            "@type": "WorkflowStep",
            "name": "Stop Instance",
            "description": null,
            "arguments": {
                "action": "stop"
            },
            "status": null,
            "top": "680",
            "left": "1780",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "76e84470-aaff-4216-9106-6d4efd6d46a6"
        },
        {
            "@type": "WorkflowStep",
            "name": "Stop Instance and Take Forensic Snapshot",
            "description": null,
            "arguments": {
                "action": "stop_snapshot"
            },
            "status": null,
            "top": "680",
            "left": "2120",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "6ee47680-cbf9-458c-846d-b0ae042f4389"
        },
        {
            "@type": "WorkflowStep",
            "name": "Take AWS Volume Snapshot",
            "description": null,
            "arguments": {
                "name": "AWS EC2",
                "config": "{{ (vars.item | split(':'))[0] }}",
                "params": {
                    "volume_id": "{{ (vars.item | split(':'))[1] }}",
                    "assume_role": false,
                    "description": "fortisoar-snapshot-alert-{{ vars.alert_details.alertId }}"
                },
                "version": "3.1.1",
                "for_each": {
                    "item": "{% set volumes=[] %}{% for instance in vars.instanceVolumes %}{% for volume in instance.volumeIds %}{% if volumes.append(volume) %}{% endif %}{% endfor %}{% endfor %}{{volumes}}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "aws",
                "operation": "snapshot_volume",
                "operationTitle": "Capture Volume Snapshot",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "500",
            "left": "380",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "uuid": "350fe794-821b-4332-a3c4-b7d72e639872"
        },
        {
            "@type": "WorkflowStep",
            "name": "Take Azure Volume Snapshot",
            "description": null,
            "arguments": {
                "name": "Azure Compute",
                "config": "{{ vars.item.PROPS.tags.SubscriptionId }}",
                "params": {
                    "tags": "",
                    "tier": "",
                    "subs_id": "{{ vars.item.PROPS.tags.SubscriptionId }}",
                    "EdgeZone": "",
                    "location": "{{ vars.item.PROPS.tags.Zone }}",
                    "diskSizeGB": "",
                    "incremental": "",
                    "createOption": "Copy",
                    "diskAccessId": "",
                    "snapshotName": "fortisoar-snapshot",
                    "sourceUniqueId": "",
                    "sourceResourceId": "{{ vars.item.PROPS.tags.OSDiskId }}",
                    "custom_attributes": "",
                    "logicalSectorSize": "",
                    "resource_group_name": "{{ vars.item.PROPS.tags.ResourceGroup }}"
                },
                "version": "1.2.0",
                "for_each": {
                    "item": "{{ vars.azure_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "azure-compute",
                "operation": "create_snapshot",
                "operationTitle": "Create Snapshot",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "361",
            "left": "337",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "24fb23e4-8103-44f6-9e1c-aa7d543433a1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Take Forensic Snapshot",
            "description": null,
            "arguments": {
                "action": "snapshot"
            },
            "status": null,
            "top": "680",
            "left": "2500",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "dd840d1d-f36c-4aee-b7e3-bd68c3af6667"
        },
        {
            "@type": "WorkflowStep",
            "name": "Take GCP Volume Snapshot",
            "description": null,
            "arguments": {
                "name": "Google Cloud Compute",
                "config": "{{ vars.item.PROPS.tags.ProjectId }}",
                "params": {
                    "zone": "{{ vars.item.PROPS.tags.Zone }}",
                    "instance_name": "{{ vars.item.PROPS.tags.InstanceName }}"
                },
                "version": "1.2.0",
                "for_each": {
                    "item": "{{ vars.gcp_machines }}",
                    "parallel": false,
                    "condition": ""
                },
                "connector": "google-cloud-compute",
                "operation": "disk_snapshot",
                "operationTitle": "Disk Snapshot",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "398",
            "left": "359",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "uuid": "baa1c4d6-f511-4365-aef8-29c4fead905e"
        },
        {
            "@type": "WorkflowStep",
            "name": "Teams Approval Action",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Alert ID {{ vars.alert_details.alertId }}: {{ vars.alert_details.alertName }}",
                        "description": "The following {% if vars.aws %}aws{% elif vars.gcp %}gcp{% elif vars.azure %}azure{% endif %} instances were identified as being potentially compromised:\n\n{% if vars.aws %}\n{% for instance in vars.machines %}\n- *Account*: `{{ instance.PROPS.tags.Account }}`\n- *InstanceId*: `{{ instance.PROPS.tags.InstanceId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.Hostname }}`\n\n{% endfor %}\n{% elif vars.gcp %}\n{% for instance in vars.gcp_machines %}\n- *OrganizationId*: `{{ instance.PROPS.tags.OrganizationId }}`\n- *ProjectId*: `{{ instance.PROPS.tags.ProjectId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.InstanceName }}`\n\n{% endfor %}\n{% elif vars.azure %}\n{% for instance in vars.azure_machines %}\n- *TenantId*: `{{ instance.PROPS.tags.TenantId }}`\n- *SubscriptionId*: `{{ instance.PROPS.tags.SubscriptionId }}`\n- *SubscriptionName*: `{{ instance.PROPS.tags.SubscriptionName }}`\n- *InstanceId*: `{{ instance.PROPS.tags.InstanceId }}`\n- *InstanceName*: `{{ instance.PROPS.tags.Hostname }}`\n\n{% endfor %}\n{% endif %}\n\nView Alert in Lacework FortiCNAPP:\nhttps:\/\/{{vars.lacework_account}}.lacework.net\/ui\/investigation\/monitor\/AlertInbox\/{{vars.alert_details.alertId}}\/details?accountName={{vars.lacework_subaccount|upper}}\n\nView Alert in FortiSOAR:\nhttps:\/\/{{globalVars.Server_fqhn}}\/modules\/alerts\/{{vars.input.records[0][\"uuid\"]}}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "assignedToTeam": [],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false,
                    "externalRecipients": "{% if vars.slack %}{{ vars.slack_channel }}{% else %}{{ vars.teams_channel }}{% endif %}"
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Stop Instance",
                            "primary": false,
                            "step_iri": "\/api\/3\/workflow_steps\/76e84470-aaff-4216-9106-6d4efd6d46a6"
                        },
                        {
                            "option": "Stop Instance and Take Volume Snapshot",
                            "step_iri": "\/api\/3\/workflow_steps\/6ee47680-cbf9-458c-846d-b0ae042f4389"
                        },
                        {
                            "option": "Take Volume Snapshot",
                            "step_iri": "\/api\/3\/workflow_steps\/dd840d1d-f36c-4aee-b7e3-bd68c3af6667"
                        },
                        {
                            "option": "Block Internet Access",
                            "step_iri": "\/api\/3\/workflow_steps\/cbe58838-1208-4f33-ad91-ba9c406ae88f"
                        },
                        {
                            "option": "No Action",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/e08a3618-e9c4-4bc9-ba77-906cce535b42"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "inputExternalUser": false,
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inputInternalUsers": true,
                "customEmailExternal": false,
                "customEmailInternal": false,
                "inline_channel_list": [
                    "\/api\/3\/picklists\/c7c35e25-9c26-4a43-a984-4f57d2027111"
                ],
                "external_channel_list": [],
                "unauthenticated_input": true,
                "external_email_subject": "A FortiSOAR playbook is requesting your input",
                "internal_email_subject": null,
                "custom_email_body_external": null,
                "custom_email_body_internal": null,
                "external_email_attachments": null,
                "internal_email_attachments": null
            },
            "status": null,
            "top": "480",
            "left": "2500",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Teams Prompt to Additional Action",
            "description": null,
            "arguments": {
                "type": "InputBased",
                "input": {
                    "schema": {
                        "title": "Alert ID {{ vars.alert_details.alertId }}: {{ vars.alert_details.alertName }}",
                        "description": "Actions associated with this alert have completed. Would you like to close the alert?\n\nView Alert in Lacework FortiCNAPP:\nhttps:\/\/{{vars.lacework_account}}.lacework.net\/ui\/investigation\/monitor\/AlertInbox\/{{vars.alert_details.alertId}}\/details?accountName={{vars.lacework_subaccount|upper}}\n\nView Alert in FortiSOAR:\nhttps:\/\/{{globalVars.Server_fqhn}}\/modules\/alerts\/{{vars.input.records[0][\"uuid\"]}}",
                        "inputVariables": []
                    }
                },
                "record": "{{ vars.input.records[0][\"@id\"] }}",
                "agent_id": null,
                "resources": "alerts",
                "is_approval": false,
                "owner_detail": {
                    "isAssigned": false,
                    "assignedToTeam": [],
                    "assignedToField": null,
                    "emailRecipients": "",
                    "assignedToPerson": [],
                    "assignedToRecord": false,
                    "externalRecipients": "{% if vars.slack %}{{ vars.slack_channel }}{% else %}{{ vars.teams_channel }}{% endif %}"
                },
                "isRecordLinked": true,
                "step_variables": [],
                "response_mapping": {
                    "options": [
                        {
                            "option": "Close Alert",
                            "step_iri": "\/api\/3\/workflow_steps\/e79af345-633f-4459-af25-f2e475f6e086"
                        },
                        {
                            "option": "No Action",
                            "primary": true,
                            "step_iri": "\/api\/3\/workflow_steps\/988a6662-fa87-4edd-b6d3-a244bc612147"
                        }
                    ],
                    "duplicateOption": false,
                    "customSuccessMessage": "Awaiting Playbook resumed successfully."
                },
                "inputExternalUser": false,
                "email_notification": {
                    "enabled": false,
                    "smtpParameters": []
                },
                "inputInternalUsers": true,
                "customEmailExternal": false,
                "customEmailInternal": false,
                "inline_channel_list": [
                    "\/api\/3\/picklists\/c7c35e25-9c26-4a43-a984-4f57d2027111"
                ],
                "external_channel_list": [],
                "unauthenticated_input": true,
                "external_email_subject": "A FortiSOAR playbook is requesting your input",
                "internal_email_subject": null,
                "custom_email_body_external": null,
                "custom_email_body_internal": null,
                "external_email_attachments": null,
                "internal_email_attachments": null
            },
            "status": null,
            "top": "460",
            "left": "560",
            "stepType": "\/api\/3\/workflow_step_types\/fc04082a-d7dc-4299-96fb-6837b1baa0fe",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "de0bf09d-7154-4ac3-b341-95e44f07db8f"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Alert Comments With Action",
            "description": null,
            "arguments": {
                "name": "Lacework FortiCNAPP",
                "config": "{{ vars.lacework_subaccount }}",
                "params": {
                    "alertId": "{{ vars.alert_details.alertId }}",
                    "comment": "FortiSOAR: Action Requested {{ vars.action }}"
                },
                "version": "1.0.0",
                "connector": "fortinet-forticnapp",
                "operation": "add_comment_to_alert",
                "operationTitle": "Add Comment to Alert",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "1480",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "uuid": "8add5617-f57f-4437-a599-e7f34a6ea6e1"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Alert Comments With Result",
            "description": null,
            "arguments": {
                "name": "Lacework FortiCNAPP",
                "config": "{{ vars.lacework_subaccount }}",
                "params": {
                    "alertId": "{{ vars.alert_details.alertId }}",
                    "comment": "FortiSOAR: Action Complete {{ vars.action }}"
                },
                "version": "1.0.0",
                "connector": "fortinet-forticnapp",
                "operation": "add_comment_to_alert",
                "operationTitle": "Add Comment to Alert",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "280",
            "left": "280",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": "\/api\/3\/workflow_groups\/09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "uuid": "de270c03-d4e8-41a1-8b08-0ac4c6421806"
        },
        {
            "@type": "WorkflowStep",
            "name": "Update Azure Machines With Resource Group",
            "description": null,
            "arguments": {
                "azure_machines": "{% set machines=[] %}\n{% set resourceGroup=[] %}\n{% set osDiskId=[] %}\n{% for machine in vars.azure_machines %}\n{% for instance in vars.steps.Get_Azure_Instance_Details %}\n{% if instance.data[0].vmId == machine.PROPS.tags.InstanceId %}\n{% if resourceGroup.append(instance.data[0].resourceGroup) %}{% endif %}\n{% if osDiskId.append(instance.data[0].storageProfile.osDisk.managedDisk.id) %}{% endif %}\n{% endif %}\n{% endfor %}\n{% set new_tag={'PROPS':{'tags':{'ResourceGroup': resourceGroup[0], 'OSDiskId': osDiskId[0] }}}  %}\n{% if machines.append((machine|combine(new_tag, recursive=True))) %}{%endif%}\n{% endfor %}\n{{ machines }}"
            },
            "status": null,
            "top": "60",
            "left": "660",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": "\/api\/3\/workflow_groups\/62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "uuid": "64d289be-0001-4162-8d35-747bd1e65e71"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Add Remediation Action Tag to Instance -> Check AWS Stop Instance Action",
            "targetStep": "\/api\/3\/workflow_steps\/85240cfd-0c2c-4ebf-b1e3-7c9b11fd38ad",
            "sourceStep": "\/api\/3\/workflow_steps\/ee23334d-2121-48f6-8838-a1ff6a7b6fbc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e286240e-dfc1-4363-9ec2-f602b1b6ec39"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Add Remediation Tag to Instance -> Block AWS Internet",
            "targetStep": "\/api\/3\/workflow_steps\/8370e996-9091-494b-ad61-016bbe25a6ff",
            "sourceStep": "\/api\/3\/workflow_steps\/20697992-7c01-4789-affb-53aca935f1f0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b94fdfc3-2331-4d7f-b347-696592c48d53"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval Action -> No Action",
            "targetStep": "\/api\/3\/workflow_steps\/e08a3618-e9c4-4bc9-ba77-906cce535b42",
            "sourceStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "label": "No Action",
            "isExecuted": false,
            "group": null,
            "uuid": "75e50a79-4fd3-42d7-8133-576f93f32472"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval Action -> Stop Instance",
            "targetStep": "\/api\/3\/workflow_steps\/76e84470-aaff-4216-9106-6d4efd6d46a6",
            "sourceStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "label": "Stop Instance",
            "isExecuted": false,
            "group": null,
            "uuid": "ee61bbea-9411-4652-a4d8-d8ca7db4f7a6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval Action -> Stop Instance and Take Forensic Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/6ee47680-cbf9-458c-846d-b0ae042f4389",
            "sourceStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "label": "Stop Instance and Take Volume Snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "0e40486b-ae9c-4f9a-b744-46edb9090faa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Approval Action -> Take Forensic Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/dd840d1d-f36c-4aee-b7e3-bd68c3af6667",
            "sourceStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "label": "Take Volume Snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "bac6cf1a-6b34-4885-a6b0-92cc4c50fa6f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "AWS Enrichment -> End",
            "targetStep": "\/api\/3\/workflow_steps\/e33302a9-a4e8-4458-bb7b-da6ceaa24d41",
            "sourceStep": "\/api\/3\/workflow_steps\/0114c7dc-d19b-4ea0-9f58-bc137f3fa60c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a581b70b-8584-458c-8c41-354174b91677"
        },
        {
            "@type": "WorkflowRoute",
            "name": "AWS Enrichment -> Get Instance Details",
            "targetStep": "\/api\/3\/workflow_steps\/6d429e9c-d4b3-4740-a1b0-becc51b29ba4",
            "sourceStep": "\/api\/3\/workflow_steps\/0114c7dc-d19b-4ea0-9f58-bc137f3fa60c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "84daa2ae-6da4-430d-96ee-56c83ec3b65a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "AWS Security Groups -> Add Original Security Groups Remediation Tag to Instance",
            "targetStep": "\/api\/3\/workflow_steps\/20697992-7c01-4789-affb-53aca935f1f0",
            "sourceStep": "\/api\/3\/workflow_steps\/f339594c-0293-4776-a0cb-85aa57995f77",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "92986d8f-d014-4744-889a-c7af9542f7a1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Azure Enrichment -> Get Azure Virtual Machine Details",
            "targetStep": "\/api\/3\/workflow_steps\/531c42d7-406f-4cf2-9611-f9cea6efaddd",
            "sourceStep": "\/api\/3\/workflow_steps\/5f840287-a9b9-4b48-9bf6-d7c14d30c7af",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "5dad4c89-61e3-4765-8c70-d9ca126895a6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Azure Enrichment -> Skip Azure Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/7cc258a8-3c0a-477b-9522-ea98aa831c36",
            "sourceStep": "\/api\/3\/workflow_steps\/5f840287-a9b9-4b48-9bf6-d7c14d30c7af",
            "label": "",
            "isExecuted": false,
            "group": null,
            "uuid": "8d0212ef-6350-4379-8c36-f890b00030b1"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Block AWS Internet -> Set Bot Message After AWS Block Internet",
            "targetStep": "\/api\/3\/workflow_steps\/58d3a076-2f52-4239-bc62-07516c2a505e",
            "sourceStep": "\/api\/3\/workflow_steps\/8370e996-9091-494b-ad61-016bbe25a6ff",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "99115276-2181-49d7-a132-d5f01b55caaa"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Block Internet Access -> Update Alert Comments With Action",
            "targetStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "sourceStep": "\/api\/3\/workflow_steps\/cbe58838-1208-4f33-ad91-ba9c406ae88f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "612c504f-f5b8-4d17-81ca-cf3820a4db3f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check AWS Revoke Egress Action -> AWS Security Groups",
            "targetStep": "\/api\/3\/workflow_steps\/f339594c-0293-4776-a0cb-85aa57995f77",
            "sourceStep": "\/api\/3\/workflow_steps\/d174b22c-0a5b-4617-b506-780180a04556",
            "label": "block internet",
            "isExecuted": false,
            "group": null,
            "uuid": "8c6fb9a1-8cd9-4f97-a102-ae0646f7a532"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check AWS Revoke Egress Action -> Skip AWS Revoke Egress",
            "targetStep": "\/api\/3\/workflow_steps\/54f7c8ce-eabe-4dd1-ab1d-d4a90f0fdbf0",
            "sourceStep": "\/api\/3\/workflow_steps\/d174b22c-0a5b-4617-b506-780180a04556",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "7cb8f312-c620-4443-affd-84c931991112"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Azure Snapshot Action -> Skip Azure Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/7ee1ebd4-a885-49b3-b7a4-357b27e038db",
            "sourceStep": "\/api\/3\/workflow_steps\/a85ea8f8-ca9e-4866-830d-b81ffbc4eb04",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "70061ff0-0bcd-45d9-b92b-ac95c6690faf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Azure Snapshot Action -> Take Azure Volume Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/24fb23e4-8103-44f6-9e1c-aa7d543433a1",
            "sourceStep": "\/api\/3\/workflow_steps\/a85ea8f8-ca9e-4866-830d-b81ffbc4eb04",
            "label": "snpshot",
            "isExecuted": false,
            "group": null,
            "uuid": "e07dd69b-f4e5-407e-8ee5-2f6215824816"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Azure Stop Instance Action -> Stop Azure Instance Action 2",
            "targetStep": "\/api\/3\/workflow_steps\/566a4f8d-651f-4701-a178-27bdac293e6a",
            "sourceStep": "\/api\/3\/workflow_steps\/80f336ac-ee72-493f-bc0b-094d94a20038",
            "label": "stop",
            "isExecuted": false,
            "group": null,
            "uuid": "42da1fcc-2411-4ba1-82b6-d30c5c5b1603"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check GCP Snapshot Action -> Skip GCP Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/6675f9a1-1249-4a74-9f84-818507511a72",
            "sourceStep": "\/api\/3\/workflow_steps\/ef85712d-7036-4a1e-a1b2-3a225864e410",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "38b9a792-80ab-4c21-b6d5-574835115df2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check GCP Snapshot Action -> Take GCP Volume Snapshot 2",
            "targetStep": "\/api\/3\/workflow_steps\/baa1c4d6-f511-4365-aef8-29c4fead905e",
            "sourceStep": "\/api\/3\/workflow_steps\/ef85712d-7036-4a1e-a1b2-3a225864e410",
            "label": "snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "82687e4c-b758-4f54-8e80-841f06df4fc8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check GCP Stop Instance Action -> Stop GCP Instance 2",
            "targetStep": "\/api\/3\/workflow_steps\/e869ae0c-cb73-42d0-ab0b-e82a31cf393a",
            "sourceStep": "\/api\/3\/workflow_steps\/3c18b10c-2b30-4ad7-80fb-093ba05686bc",
            "label": "stop",
            "isExecuted": false,
            "group": null,
            "uuid": "6c73517c-9d1a-4d1e-b71b-f39eb0190758"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Snapshot Action -> Skip Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/41bb455a-cde3-47d8-a63a-4bf190eaeb61",
            "sourceStep": "\/api\/3\/workflow_steps\/1ab23e9f-b041-43e7-8303-30fab2803e44",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "f3974959-0785-4eb2-9686-19e05fbb8ae2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Snapshot Action -> Take Volume Snapsho",
            "targetStep": "\/api\/3\/workflow_steps\/350fe794-821b-4332-a3c4-b7d72e639872",
            "sourceStep": "\/api\/3\/workflow_steps\/1ab23e9f-b041-43e7-8303-30fab2803e44",
            "label": "snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "ec1ae974-1b16-439b-8e1c-dc8895cb64d8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Stop Instance Action -> Skip",
            "targetStep": "\/api\/3\/workflow_steps\/e76ea4e4-2c23-4b13-9cce-86b953401283",
            "sourceStep": "\/api\/3\/workflow_steps\/85240cfd-0c2c-4ebf-b1e3-7c9b11fd38ad",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "f9c59bad-3210-4f6c-a759-3575bf463046"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check Stop Instance Action -> Stop Instance Action",
            "targetStep": "\/api\/3\/workflow_steps\/a02cbfb8-75a3-4ca4-8166-915d251086ea",
            "sourceStep": "\/api\/3\/workflow_steps\/85240cfd-0c2c-4ebf-b1e3-7c9b11fd38ad",
            "label": "stop",
            "isExecuted": false,
            "group": null,
            "uuid": "91f0d77b-c493-49df-8cc9-7462fc21d743"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Close Alert -> Close Lacework Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e4eb8190-7e71-4da9-9741-47b51c5d0ef8",
            "sourceStep": "\/api\/3\/workflow_steps\/e79af345-633f-4459-af25-f2e475f6e086",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "5eedcd8e-00a4-48cd-a514-605065bf0f2f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Set AWS Security Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/dca1f4ed-62ee-4468-ace1-3833e33dd8a9",
            "sourceStep": "\/api\/3\/workflow_steps\/aa779e39-8ebe-4eb2-aba2-fa9e9312ac65",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "8b52b604-8334-418c-9137-7760144f1f66"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy of Check Stop Instance Action -> Copy of Skip Stop",
            "targetStep": "\/api\/3\/workflow_steps\/a83fa151-2074-43c0-9c1d-cc3f681633cb",
            "sourceStep": "\/api\/3\/workflow_steps\/3c18b10c-2b30-4ad7-80fb-093ba05686bc",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "922eb356-9dce-45b9-80b2-928f0d288b30"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Copy of Copy of Check Stop Instance Action -> Copy of Copy of Skip Stop",
            "targetStep": "\/api\/3\/workflow_steps\/b6503915-6fe9-496b-9584-f25491dff3f6",
            "sourceStep": "\/api\/3\/workflow_steps\/80f336ac-ee72-493f-bc0b-094d94a20038",
            "label": "skip",
            "isExecuted": false,
            "group": null,
            "uuid": "bc679a10-e83a-4596-a049-8f7696331e2b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Format AWS Response -> Send Channel Response",
            "targetStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "sourceStep": "\/api\/3\/workflow_steps\/6433799d-fa71-4e98-b08b-fe9d66142036",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "464d8298-5e89-4e2a-9529-a75955766559"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Format Azure Response -> Send Channel Response",
            "targetStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "sourceStep": "\/api\/3\/workflow_steps\/9fe44bd4-b3e1-428e-94e3-d3908453a9dc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f78e6f98-91af-415c-afe8-d1bc3563be7a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Format GCP Response -> Send Channel Response",
            "targetStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "sourceStep": "\/api\/3\/workflow_steps\/f0a5b9ab-a427-4999-8b55-11b40aa92fa8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "13418afb-8576-4abe-baab-5498ff520759"
        },
        {
            "@type": "WorkflowRoute",
            "name": "GCP Enrichment -> Get GCP Instance Details",
            "targetStep": "\/api\/3\/workflow_steps\/196ae57a-701f-47c4-b753-7c25dcee418f",
            "sourceStep": "\/api\/3\/workflow_steps\/0697d91a-145f-4563-88f2-9f3d45965a7c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "8aafdd58-fc0f-4298-a653-6e53011052cb"
        },
        {
            "@type": "WorkflowRoute",
            "name": "GCP Enrichment -> Skip GCP Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/b68a1e49-ae81-4e89-bd4e-20bf0c924430",
            "sourceStep": "\/api\/3\/workflow_steps\/0697d91a-145f-4563-88f2-9f3d45965a7c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "2bb27cb6-3c78-4a38-b0e0-bed668c847da"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get AWS Instance Details -> Map Instance to Instance Volumes",
            "targetStep": "\/api\/3\/workflow_steps\/e9e6e3ca-bf43-4bbc-a7db-2c8294fe7c74",
            "sourceStep": "\/api\/3\/workflow_steps\/6d429e9c-d4b3-4740-a1b0-becc51b29ba4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "8237be6a-3c48-4500-b6bb-76f186a497b2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Azure Instance Details -> Update Azure Machines With Resource Group",
            "targetStep": "\/api\/3\/workflow_steps\/64d289be-0001-4162-8d35-747bd1e65e71",
            "sourceStep": "\/api\/3\/workflow_steps\/531c42d7-406f-4cf2-9611-f9cea6efaddd",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "4919ec61-5430-4911-9838-aa5c407308ed"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get GCP Instance Details -> Check GCP Stop Instance Action",
            "targetStep": "\/api\/3\/workflow_steps\/3c18b10c-2b30-4ad7-80fb-093ba05686bc",
            "sourceStep": "\/api\/3\/workflow_steps\/196ae57a-701f-47c4-b753-7c25dcee418f",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "592b5b36-5a41-445f-bd84-5557544d20a2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Map Instance to Instance Volumes -> Add Remediation Action Tag to Instance",
            "targetStep": "\/api\/3\/workflow_steps\/ee23334d-2121-48f6-8838-a1ff6a7b6fbc",
            "sourceStep": "\/api\/3\/workflow_steps\/e9e6e3ca-bf43-4bbc-a7db-2c8294fe7c74",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "5cbfd20f-facf-4889-8035-5946ef478437"
        },
        {
            "@type": "WorkflowRoute",
            "name": "No Action -> Send Channel Response",
            "targetStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "sourceStep": "\/api\/3\/workflow_steps\/e08a3618-e9c4-4bc9-ba77-906cce535b42",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "56512668-be8f-4ad3-b745-0940c97cbdf6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Payload -> Payload Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/aa779e39-8ebe-4eb2-aba2-fa9e9312ac65",
            "sourceStep": "\/api\/3\/workflow_steps\/3cc4b746-6ed4-4063-9172-b42dc2d95daf",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "69de1b20-09c7-4d87-b206-4fbe9630f072"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval Action -> Slack Approval Action",
            "targetStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "sourceStep": "\/api\/3\/workflow_steps\/b0c3d099-b158-46a6-8a1a-be7a25bb684e",
            "label": "slack",
            "isExecuted": false,
            "group": null,
            "uuid": "39afbeb4-cbfb-438f-a814-956f7a4467dd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Approval Action -> Teams Approval Action",
            "targetStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "sourceStep": "\/api\/3\/workflow_steps\/b0c3d099-b158-46a6-8a1a-be7a25bb684e",
            "label": "teams",
            "isExecuted": false,
            "group": null,
            "uuid": "c6051df4-ef08-4994-b2f4-6019b35ea7d4"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Channel Response -> Send Response",
            "targetStep": "\/api\/3\/workflow_steps\/8086973a-9e1f-40dc-9e9d-f429c6742496",
            "sourceStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "label": "slack",
            "isExecuted": false,
            "group": null,
            "uuid": "5bd1912b-fc37-4ce8-b5d9-06193675ae6a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Channel Response -> Send Teams Response",
            "targetStep": "\/api\/3\/workflow_steps\/f650e38b-294e-4b37-83a1-815e2e471afe",
            "sourceStep": "\/api\/3\/workflow_steps\/4ffca273-5190-459e-a8a4-aeb92945f81e",
            "label": "teams",
            "isExecuted": false,
            "group": null,
            "uuid": "bc9505c7-8b47-483c-a826-b28f6bbe7885"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Prompt for Additional Action -> Slack Prompt to Additional Action",
            "targetStep": "\/api\/3\/workflow_steps\/4cf8cad9-d8dd-4e53-9150-a18291a5df19",
            "sourceStep": "\/api\/3\/workflow_steps\/b9ddd357-cfc6-43dc-80ef-2b0b3f68a3f7",
            "label": "slack",
            "isExecuted": false,
            "group": null,
            "uuid": "e56fb4d9-d97b-44d7-9986-05625019c01d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Prompt for Additional Action -> Teams Prompt to Additional Action",
            "targetStep": "\/api\/3\/workflow_steps\/de0bf09d-7154-4ac3-b341-95e44f07db8f",
            "sourceStep": "\/api\/3\/workflow_steps\/b9ddd357-cfc6-43dc-80ef-2b0b3f68a3f7",
            "label": "teams",
            "isExecuted": false,
            "group": null,
            "uuid": "60ba58c2-3473-4f7b-9e52-82f6fcfdd973"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Response -> Copy of Update Alert Comments With Action",
            "targetStep": "\/api\/3\/workflow_steps\/de270c03-d4e8-41a1-8b08-0ac4c6421806",
            "sourceStep": "\/api\/3\/workflow_steps\/8086973a-9e1f-40dc-9e9d-f429c6742496",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "118ef8e9-82f4-4d0b-93ae-d4880dd20185"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Send Teams Response -> Update Alert Comments With Result",
            "targetStep": "\/api\/3\/workflow_steps\/de270c03-d4e8-41a1-8b08-0ac4c6421806",
            "sourceStep": "\/api\/3\/workflow_steps\/f650e38b-294e-4b37-83a1-815e2e471afe",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "82ad082b-b4c8-45ff-a70e-d1e7bbc9cbc6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set AWS Security Configuration -> Set Slack and Teams Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/6e76b5f2-6cb3-4eae-b4b3-77e6b538e812",
            "sourceStep": "\/api\/3\/workflow_steps\/dca1f4ed-62ee-4468-ace1-3833e33dd8a9",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e05ab408-4d00-402f-bf37-55e71596c7c3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After AWS Revoke Egress -> Format AWS Response",
            "targetStep": "\/api\/3\/workflow_steps\/6433799d-fa71-4e98-b08b-fe9d66142036",
            "sourceStep": "\/api\/3\/workflow_steps\/58d3a076-2f52-4239-bc62-07516c2a505e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "8ab3d653-7117-4376-a46b-46b7034fe640"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After AWS Snapshot -> Check AWS Revoke Egress Action",
            "targetStep": "\/api\/3\/workflow_steps\/d174b22c-0a5b-4617-b506-780180a04556",
            "sourceStep": "\/api\/3\/workflow_steps\/937623e9-daea-4475-b9e9-672031fdbfcc",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "14b2b437-a574-4f46-b8d6-bf6d2a16a33e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After Azure Block Internet Not Supported -> Format Azure Response",
            "targetStep": "\/api\/3\/workflow_steps\/9fe44bd4-b3e1-428e-94e3-d3908453a9dc",
            "sourceStep": "\/api\/3\/workflow_steps\/8937a756-e5b7-40e4-b475-bb4808a04ba8",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6bd42c52-dcd0-4c92-8aec-ccc51f365a58"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After Azure Instance Stop -> Check Azure Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/a85ea8f8-ca9e-4866-830d-b81ffbc4eb04",
            "sourceStep": "\/api\/3\/workflow_steps\/708aacb7-bdbd-4bff-b7e9-38f4789ada37",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e38da2de-985f-437e-a5aa-18d331f54135"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After Azure Snapshot -> Set Bot Message Azure Not Supported",
            "targetStep": "\/api\/3\/workflow_steps\/8937a756-e5b7-40e4-b475-bb4808a04ba8",
            "sourceStep": "\/api\/3\/workflow_steps\/46af9b84-30ee-4e01-b579-b91fb6526045",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e7c0d57e-dd37-46a7-aa48-6dcccc00350d"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After GCP Block Internet Not Supported -> Format GCP Response",
            "targetStep": "\/api\/3\/workflow_steps\/f0a5b9ab-a427-4999-8b55-11b40aa92fa8",
            "sourceStep": "\/api\/3\/workflow_steps\/208a5a30-195f-4fcb-be00-d0e4a4434ffd",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "ae2d6ae8-51e7-41d6-b421-8984e9e8a026"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After GCP Instance Stop -> Check GCP Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/ef85712d-7036-4a1e-a1b2-3a225864e410",
            "sourceStep": "\/api\/3\/workflow_steps\/e702b453-33b4-4f8c-bbc7-7e42b5fc7395",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6385801d-65c0-4ba9-bb23-90290d18b486"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After GCP Snapshot -> Set Bot Message After GCP Block Internet Not Supported",
            "targetStep": "\/api\/3\/workflow_steps\/208a5a30-195f-4fcb-be00-d0e4a4434ffd",
            "sourceStep": "\/api\/3\/workflow_steps\/83f59eaa-bfbe-4dc9-aa31-8af616122334",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "eebfc085-d69c-4b41-a5b8-e6d65e20f6b8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Bot Message After Instance Stop -> Check Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/1ab23e9f-b041-43e7-8303-30fab2803e44",
            "sourceStep": "\/api\/3\/workflow_steps\/8eef4a31-4685-46e6-895b-9f528a5ea9f1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "79e82731-51dc-4e9c-8e2f-f74affed12d6"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Set Slack and Teams Configuration -> Send Approval Action",
            "targetStep": "\/api\/3\/workflow_steps\/b0c3d099-b158-46a6-8a1a-be7a25bb684e",
            "sourceStep": "\/api\/3\/workflow_steps\/6e76b5f2-6cb3-4eae-b4b3-77e6b538e812",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "42b5f09c-5d20-4520-8f8c-c7b43aa1c109"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip AWS Block Internet -> Format AWS Response",
            "targetStep": "\/api\/3\/workflow_steps\/6433799d-fa71-4e98-b08b-fe9d66142036",
            "sourceStep": "\/api\/3\/workflow_steps\/54f7c8ce-eabe-4dd1-ab1d-d4a90f0fdbf0",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6a075dae-8792-4cce-84fc-d642a025615c"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip AWS Snapshot -> Check AWS Revoke Egress Action",
            "targetStep": "\/api\/3\/workflow_steps\/d174b22c-0a5b-4617-b506-780180a04556",
            "sourceStep": "\/api\/3\/workflow_steps\/41bb455a-cde3-47d8-a63a-4bf190eaeb61",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "54fa9284-7ff7-4c24-8d14-3986ba48cbff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip Azure Snapshot -> Set Bot Message Azure Not Supported",
            "targetStep": "\/api\/3\/workflow_steps\/8937a756-e5b7-40e4-b475-bb4808a04ba8",
            "sourceStep": "\/api\/3\/workflow_steps\/7ee1ebd4-a885-49b3-b7a4-357b27e038db",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f1c599be-67eb-4de8-87ea-d672f1415362"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip Azure Stop -> Check Azure Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/a85ea8f8-ca9e-4866-830d-b81ffbc4eb04",
            "sourceStep": "\/api\/3\/workflow_steps\/b6503915-6fe9-496b-9584-f25491dff3f6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "aa425835-2fd8-41fc-9ce5-2d274f5250f3"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip GCP Snapshot -> Set Bot Message After GCP Block Internet Not Supported",
            "targetStep": "\/api\/3\/workflow_steps\/208a5a30-195f-4fcb-be00-d0e4a4434ffd",
            "sourceStep": "\/api\/3\/workflow_steps\/6675f9a1-1249-4a74-9f84-818507511a72",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6a590297-8511-43ec-8814-be5f3d48a3ad"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip GCP Stop -> Check GCP Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/ef85712d-7036-4a1e-a1b2-3a225864e410",
            "sourceStep": "\/api\/3\/workflow_steps\/a83fa151-2074-43c0-9c1d-cc3f681633cb",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1b6ef2b6-a5f4-43ff-a0b7-9ab93695ecdd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Skip Stop -> Check Snapshot Action",
            "targetStep": "\/api\/3\/workflow_steps\/1ab23e9f-b041-43e7-8303-30fab2803e44",
            "sourceStep": "\/api\/3\/workflow_steps\/e76ea4e4-2c23-4b13-9cce-86b953401283",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "60f4b4b0-3e11-4623-b4a9-3b695e96ea65"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Slack Approval Action -> Attach Security Group",
            "targetStep": "\/api\/3\/workflow_steps\/cbe58838-1208-4f33-ad91-ba9c406ae88f",
            "sourceStep": "\/api\/3\/workflow_steps\/cc17b48d-210d-4bd6-93d8-fb3289e0a3a0",
            "label": "Block Internet Access",
            "isExecuted": false,
            "group": null,
            "uuid": "01e56780-9a98-4e04-a4fd-35761a2ba4ff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Slack Prompt to Additional Action -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e79af345-633f-4459-af25-f2e475f6e086",
            "sourceStep": "\/api\/3\/workflow_steps\/4cf8cad9-d8dd-4e53-9150-a18291a5df19",
            "label": "Close Alert",
            "isExecuted": false,
            "group": null,
            "uuid": "b474b5c1-ca9f-41b9-af06-744f1b91907b"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Slack Prompt to Additional Action -> No Action For Alert",
            "targetStep": "\/api\/3\/workflow_steps\/988a6662-fa87-4edd-b6d3-a244bc612147",
            "sourceStep": "\/api\/3\/workflow_steps\/4cf8cad9-d8dd-4e53-9150-a18291a5df19",
            "label": "No Action",
            "isExecuted": false,
            "group": null,
            "uuid": "2a4a1fde-43e7-4607-835a-88bbaf60c674"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Payload",
            "targetStep": "\/api\/3\/workflow_steps\/3cc4b746-6ed4-4063-9172-b42dc2d95daf",
            "sourceStep": "\/api\/3\/workflow_steps\/d7b24651-b8fa-4b8e-8de0-4cf88b63a0b3",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "f28f8b19-80cc-439c-8a87-0d608c31ed3a"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Stop Azure Instance Action 2 -> Set Bot Message After Azure Instance Stop",
            "targetStep": "\/api\/3\/workflow_steps\/708aacb7-bdbd-4bff-b7e9-38f4789ada37",
            "sourceStep": "\/api\/3\/workflow_steps\/566a4f8d-651f-4701-a178-27bdac293e6a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e54caa28-d796-49a5-bcd2-3bd3cfb3dc91"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Stop GCP Instance Action -> Set Bot Message After GCP Instance Stop",
            "targetStep": "\/api\/3\/workflow_steps\/e702b453-33b4-4f8c-bbc7-7e42b5fc7395",
            "sourceStep": "\/api\/3\/workflow_steps\/e869ae0c-cb73-42d0-ab0b-e82a31cf393a",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b7ea2264-84c1-4b9d-90f7-2911b55e7bd7"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Stop Instance Action -> Set Bot Message After Instance Stop",
            "targetStep": "\/api\/3\/workflow_steps\/8eef4a31-4685-46e6-895b-9f528a5ea9f1",
            "sourceStep": "\/api\/3\/workflow_steps\/a02cbfb8-75a3-4ca4-8166-915d251086ea",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "e3b227c7-cd3e-4f4e-ac71-2c5fc5fe6d73"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Stop Instance and Take Forensic Snapshot -> Update Alert Comments With Action",
            "targetStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "sourceStep": "\/api\/3\/workflow_steps\/6ee47680-cbf9-458c-846d-b0ae042f4389",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "2ec7a52e-191e-47d6-b56f-4702c6e13937"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Stop Instance -> Update Alert Comments With Action",
            "targetStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "sourceStep": "\/api\/3\/workflow_steps\/76e84470-aaff-4216-9106-6d4efd6d46a6",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "bbd83a3b-7155-476d-8046-14366a7356ee"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Take Azure Volume Snapshot -> Set Bot Message After Azure Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/46af9b84-30ee-4e01-b579-b91fb6526045",
            "sourceStep": "\/api\/3\/workflow_steps\/24fb23e4-8103-44f6-9e1c-aa7d543433a1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "808c6d9c-8e94-4e64-997c-d1d5476ac192"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Take Forensic Snapshot -> Update Alert Comments With Action",
            "targetStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "sourceStep": "\/api\/3\/workflow_steps\/dd840d1d-f36c-4aee-b7e3-bd68c3af6667",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "c17ca08c-3be1-4963-88dd-486b69bfc6bd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Take GCP Volume Snapshot 2 -> Set Bot Message After GCP Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/83f59eaa-bfbe-4dc9-aa31-8af616122334",
            "sourceStep": "\/api\/3\/workflow_steps\/baa1c4d6-f511-4365-aef8-29c4fead905e",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b63caee9-5daa-4e39-a91c-64a581c8e6dd"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Take Volume Snapshot -> Set Bot Message After Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/937623e9-daea-4475-b9e9-672031fdbfcc",
            "sourceStep": "\/api\/3\/workflow_steps\/350fe794-821b-4332-a3c4-b7d72e639872",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "13ac0d36-7c3b-4df0-ba04-4cfb1ceb20bf"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Approval Action -> Attach Security Group",
            "targetStep": "\/api\/3\/workflow_steps\/cbe58838-1208-4f33-ad91-ba9c406ae88f",
            "sourceStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "label": "Block Internet Access",
            "isExecuted": false,
            "group": null,
            "uuid": "1ca3473f-4d72-4f33-b575-a4f72f39ae53"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Approval Action -> No Action",
            "targetStep": "\/api\/3\/workflow_steps\/e08a3618-e9c4-4bc9-ba77-906cce535b42",
            "sourceStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "label": "No Action",
            "isExecuted": false,
            "group": null,
            "uuid": "8806d0ed-abf8-4d8d-8cd0-cb662d1ae7fc"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Approval Action -> Stop Instance",
            "targetStep": "\/api\/3\/workflow_steps\/76e84470-aaff-4216-9106-6d4efd6d46a6",
            "sourceStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "label": "Stop Instance",
            "isExecuted": false,
            "group": null,
            "uuid": "fa5ab827-d389-47f6-8d5f-2d179dbdbc2f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Approval Action -> Stop Instance and Take Forensic Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/6ee47680-cbf9-458c-846d-b0ae042f4389",
            "sourceStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "label": "Stop Instance and Take Volume Snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "f29f068e-a649-4b27-a5fb-781bb310c466"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Approval Action -> Take Forensic Snapshot",
            "targetStep": "\/api\/3\/workflow_steps\/dd840d1d-f36c-4aee-b7e3-bd68c3af6667",
            "sourceStep": "\/api\/3\/workflow_steps\/fab47a7b-50d8-4ca3-ba1c-95a59b21f3c8",
            "label": "Take Volume Snapshot",
            "isExecuted": false,
            "group": null,
            "uuid": "f0465e4e-79cb-48db-aefa-258273161763"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Prompt to Additional Action -> Close Alert",
            "targetStep": "\/api\/3\/workflow_steps\/e79af345-633f-4459-af25-f2e475f6e086",
            "sourceStep": "\/api\/3\/workflow_steps\/de0bf09d-7154-4ac3-b341-95e44f07db8f",
            "label": "Close Alert",
            "isExecuted": false,
            "group": null,
            "uuid": "d08d5e2f-404a-46be-8f1f-105673e2c5d2"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Teams Prompt to Additional Action -> No Action For Alert",
            "targetStep": "\/api\/3\/workflow_steps\/988a6662-fa87-4edd-b6d3-a244bc612147",
            "sourceStep": "\/api\/3\/workflow_steps\/de0bf09d-7154-4ac3-b341-95e44f07db8f",
            "label": "No Action",
            "isExecuted": false,
            "group": null,
            "uuid": "9a94bfd2-1dc0-48b3-97e1-68ea4c501b7f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Alert Comments With Action -> AWS Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/0114c7dc-d19b-4ea0-9f58-bc137f3fa60c",
            "sourceStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "6636afdb-6e52-4bba-96ad-34ca06287f73"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Alert Comments With Action -> Azure Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/5f840287-a9b9-4b48-9bf6-d7c14d30c7af",
            "sourceStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "78d50b51-4f76-4c07-891a-fc32311bd3ac"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Alert Comments With Action -> GCP Enrichment",
            "targetStep": "\/api\/3\/workflow_steps\/0697d91a-145f-4563-88f2-9f3d45965a7c",
            "sourceStep": "\/api\/3\/workflow_steps\/8add5617-f57f-4437-a599-e7f34a6ea6e1",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "9b917550-fa27-4eda-b2f9-8a335c075847"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Alert Comments With Result -> Send Prompt for Additional Action",
            "targetStep": "\/api\/3\/workflow_steps\/b9ddd357-cfc6-43dc-80ef-2b0b3f68a3f7",
            "sourceStep": "\/api\/3\/workflow_steps\/de270c03-d4e8-41a1-8b08-0ac4c6421806",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "a73e25cc-cfa6-414a-9235-f90f17cd6cc9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Update Azure Machines With Resource Group -> Check Azure Stop Instance Action",
            "targetStep": "\/api\/3\/workflow_steps\/80f336ac-ee72-493f-bc0b-094d94a20038",
            "sourceStep": "\/api\/3\/workflow_steps\/64d289be-0001-4162-8d35-747bd1e65e71",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "c9460827-29c6-460d-91fa-5d22869e826c"
        }
    ],
    "groups": [
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Alert Approve Close",
            "description": "This block is responsible to for requesting an approval to close the Lacework alert in the Lacework console.",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "3600",
            "left": "1600",
            "height": "323",
            "width": "812",
            "uuid": "32420e60-b900-4bad-853e-43cecb25de86",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Composite Alert Machine Action Approval (Slack)",
            "description": "This block reads lacework machine related composite alert details (e.g. Potentially Compromised Host) and requests approval for action via slack.",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "240",
            "left": "400",
            "height": "934",
            "width": "3176",
            "uuid": "e0a3d548-924c-463e-b9e2-a74ab5df46af",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert AWS Enrichment",
            "description": "Pulls machine details from AWS using the instance-id",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1220",
            "left": "720",
            "height": "255",
            "width": "658",
            "uuid": "e71e4003-4a11-49da-a66c-1b8a91bdc099",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert Azure Actions",
            "description": "This block is responsible for taking the approved action on the identified machine",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1500",
            "left": "2500",
            "height": "1473",
            "width": "969",
            "uuid": "62c84c3d-d873-4b38-92fd-10ac88cc8fd0",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert Azure Enrichment",
            "description": "Pulls machine details from Azure using the instance details",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1220",
            "left": "2660",
            "height": "248",
            "width": "640",
            "uuid": "a5fa5ed2-4537-448d-a8aa-384b5f6260f6",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert GCP Actions",
            "description": "This block is responsible to taking the approved action on the identified machine",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1500",
            "left": "1520",
            "height": "1474",
            "width": "965",
            "uuid": "39f5f245-9ea4-4d08-8519-8ace4b10fce0",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert GCP Enrichment",
            "description": "Pulls machine details from GCP using the instance name",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1220",
            "left": "1640",
            "height": "248",
            "width": "680",
            "uuid": "372e94c5-3efa-4383-9606-dd4daa5c0e9b",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine Alert Send Action Result (Slack)",
            "description": "This block is responsible for sending the results of the action taken to slack and updating the Lacework Alert comments in the Lacework console.",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "3000",
            "left": "1600",
            "height": "583",
            "width": "826",
            "uuid": "09f19f5c-559a-4dfd-b005-da79e4ef6676",
            "recordTags": []
        },
        {
            "@type": "WorkflowGroup",
            "name": "Lacework Machine AWS Alert Actions",
            "description": "This block is responsible for taking approved actions on the identified machines",
            "type": "block",
            "isCollapsed": false,
            "hasTriggerStep": false,
            "hideInLogs": false,
            "metadata": [],
            "reusable": false,
            "top": "1500",
            "left": "540",
            "height": "1474",
            "width": "971",
            "uuid": "d914c7f0-25a8-47fc-9068-e6045e2285d7",
            "recordTags": []
        }
    ],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "e90d0b0a-db68-4ba3-9004-19a18f9b17ca",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "alerts",
        "FortiCNAPP",
        "Lacework",
        "response"
    ]
}